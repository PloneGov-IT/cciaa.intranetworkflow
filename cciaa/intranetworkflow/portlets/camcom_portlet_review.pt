<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="plone">

<body>

<!-- The CamCom review box -->
<div metal:define-macro="portlet"
     tal:define="DateTime python:modules['DateTime'].DateTime;
                 results context/my_camcom_worklist;
				 member view/getMember;
                 rolesInContext python:member.getRolesInContext(context);
                 toLocalizedTime nocall:context/@@plone/toLocalizedTime;">

    <dl class="portlet" id="portlet-workflow-camcom-review"
	     tal:condition="python: rolesInContext and ('CUff' in rolesInContext or 'CSer' in rolesInContext)">

        <dt class="portletHeader">Da controllare</dt>

        <dd class="portletItem">

            <div class="portletContent odd" tal:condition="not:results">
                Nessuno
            </div>

            <tal:block repeat="o results">
            <div tal:define="oddrow repeat/o/odd"
                 tal:attributes="class python:(oddrow and 'portletContent odd') or 'portletContent even'">

                    <a href="#"
                       class="marker"
                       tal:attributes="href string:${o/absolute_url}/view;
                                       title o/Description">
                        <img src="" height="16" width="16"
                             tal:attributes="src string:${here/portal_url}/${o/getIcon};
                                             title o/Type;" />
                        <span tal:replace="o/Title|o/getId">
                        	Extended Calendar Product
                        </span>
                    </a>

                    <div class="portletDetails"
                         tal:define="moddate o/ModificationDate;"
                         tal:content="python:toLocalizedTime(moddate)">July 7, 08:11</div>
            </div>
            </tal:block>

            <div tal:condition="python:'CSer' in rolesInContext"
                 tal:define="url_to_here python:(context.isPrincipiaFolderish and context.absolute_url()) or context.getParentNode().absolute_url()">
               <a tal:condition="python:context.REQUEST.get('showcuff',None)!='y'" href="#" tal:attributes="href string:${url_to_here}?showcuff=y">Vedi lista cuff</a>
	       <a tal:condition="python:context.REQUEST.get('showcuff',None)=='y'" href="#" tal:attributes="href string:${url_to_here}">Vedi lista cser</a>
            </div>


        </dd>

    </dl>

</div>

</body>

</html>